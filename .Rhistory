setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
library(R.matlab)
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_data$GTEx.gene.names[1]
GTEx_gene_names <- unlist(GTEx_data$GTEx.gene.names)
length(GTEx_gene_names)
GTEx_gene_names[1]
GTEx_gene_names[2]
GTEx_sample_IDs <- unlist(GTEx_data$GTEx.sampleIDs)
GTEx_sample_IDs[1]
length(GTEx_sample_IDs)
GTEx_sample_ID_all <- unlist(GTEx_data$GTEx.sampleID.all)
length(GTEx_sample_ID_all)
GTEx_sample_tissue <- unlist(GTEx_data$GTEx.sample.tissue)
length(GTEx_sample_tissue)
GTEx_RNAseq_lung<-GTEx_data$GTEx.RNAseq.lung
dim(GTEx_RNAseq_lung)
class(GTEx_RNAseq_lung)
GTEx_sample_ID_lung <- unlist(GTEx_data$GTEx.sample.ID.lung)
GTEx_sample_ID_lung_common<-unlist(GTEx_data$GTEx.sample.lung.ID.common)
GTEx_sample_lung_index<-unlist(GTEx_data$GTEx.sample.lung.index)
GTEx_sample_lung_index_anno<-unlist(GTEx_data$GTEx.sample.lung.index.anno)
GTEx_RNAseq_blood<-GTEx_data$GTEx.RNAseq.blood
class(GTEx_RNAseq_blood)
GTEx_sample_ID_blood<-unlist(GTEx_data$GTEx.sample.ID.blood)
GTEx_sample_blood_ID_common<-unlist(GTEx_data$GTEx.sample.blood.ID.common)
GTEx_sample_blood_index<-unlist(GTEx_data$GTEx.sample.blood.index)
class(GTEx_sample_blood_index)
GTEx_sample_blood_index_anno<-unlist(GTEx_data$GTEx.sample.blood.index.anno)
GTEx_data$MCOS
dim(GTEx_RNAseq_lung)
# save the data from MATLAB
save(GTEx_data,file = 'GTEx_data.RData')
save(GTEx_gene_names,GTEx_RNAseq_blood,GTEx_RNAseq_lung,GTEx_sample_blood_ID_common,GTEx_sample_blood_index,
GTEx_sample_blood_index_anno,GTEx_sample_ID_all,GTEx_sample_ID_blood,GTEx_sample_ID_lung,GTEx_sample_ID_lung_common,
GTEx_sample_IDs,GTEx_sample_lung_index,GTEx_sample_lung_index_anno,GTEx_sample_tissue,file = 'GTEx_lung_blood.RData')
a<-matrix(rexp(10,rate = .1),ncol = 2)
a
a<-ceiling(a)
a
a!=0
which(a)
which(a>1)
which(rowSums(a!=1))
which(rowSums(a!=1)>0)
rowSums(a>1)
rowSums(a!=1)
rowSums(a!=0)
# filter the data
read_counts_threshold <- 100
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
# filter the data
read_counts_threshold <- 500
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
# filter the data
read_counts_threshold <- 0
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
dim(GTEx_RNAseq_lung)
# filter the data
read_counts_threshold <- 100
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
# filter the data
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
GTEx_RNAseq_lung_filtered <- GTEx_RNAseq_lung[tmp_idx,]
dim(GTEx_RNAseq_lung_filtered)
sum(GTEx_RNAseq_lung_filtered)
setwd("~/Dropbox/Public/MIT/CDSeq_R_package")
install.packages('CDSeq_1.0.4.tar.gz',repos = NULL, type = "source")
library(CDSeq)
pwd
setwd("~/Dropbox/Public/NIH/Project 1/Deconvolution_MATLAB_code")
# gene name and gene length
gene_name_and_gene_length <- readMat('GENE_NAME_AND_LENGTH.mat')
gene_name <- unlist(gene_name_and_gene_length$GENE.NAME.LIST)
gene_length <- unlist(gene_name_and_gene_length$GENE.NAME.LENGTH)
setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
save(gene_length,gene_name,file = 'GENE_NAME_and_LENGTH.RData')
length(GTEx_gene_names)
length(gene_name)
a<-c(1,4,5)
b<-c(3,4,3,2,5,9)
intersect(a,b)
a<-c(1,5,4,5)
intersect(a,b)
a<-c('a','g','d','e')
b<-c('b','c','a','e','d')
intersect(a,b)
intersect(a,b)
c<-intersect(a,b)
c
match(c,a)
a
# get the gene length
GTEx_gene_names_common <- intersect(GTEx_gene_names,gene_name)
length(GTEx_gene_names_common)
view(GTEx_gene_names)
View(GTEx_gene_names)
setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_gene_names_original<-GTEx_data$GTEx.gene.names.original
# save the data from MATLAB
save(GTEx_data,file = 'GTEx_data.RData')
save(GTEx_gene_names,GTEx_gene_names_original,GTEx_RNAseq_blood,GTEx_RNAseq_lung,GTEx_sample_blood_ID_common,GTEx_sample_blood_index,
GTEx_sample_blood_index_anno,GTEx_sample_ID_all,GTEx_sample_ID_blood,GTEx_sample_ID_lung,GTEx_sample_ID_lung_common,
GTEx_sample_IDs,GTEx_sample_lung_index,GTEx_sample_lung_index_anno,GTEx_sample_tissue,file = 'GTEx_lung_blood.RData')
View(GTEx_RNAseq_lung_filtered)
if (!requireNamespace("BiocManager", quietly=TRUE))
install.packages("BiocManager")
BiocManager::install("TCGAbiolinks")
library(TCGAbiolinks)
library(dplyr)
library(DT
)
packageVersion("TCGAbiolinks")
setwd("~/Dropbox/Public/MIT/Project_3_SKCM")
# TCGA SKCM data
TCGA_SKCM_data <- readMat('TCGA_SKCM_data.mat')
TCGA_SKCM_emsembl_idx <- TCGA_SKCM_data$EMSEMBL.idx
TCGA_SKCM_RNAseq <- TCGA_SKCM_data$TCGA.SKCM.RNAseq
TCGA_SKCM_RNAseq_gl <- TCGA_SKCM_data$TCGA.SKCM.RNAseq.gl
TCGA_SKCM_gene_id <- TCGA_SKCM_data$TCGA.SKCM.gene.id
TCGA_SKCM_gene_id_common_ensembl <- TCGA_SKCM_data$TCGA.SKCM.gene.id.common.ensembl
TCGA_SKCM_gene_length <- TCGA_SKCM_data$TCGA.SKCM.gene.length
TCGA_SKCM_gene_name <- TCGA_SKCM_data$TCGA.SKCM.gene.name
TCGA_SKCM_idx <- TCGA_SKCM_data$TCGA.idx
TCGA_SKCM_RNAseq_nonzero <- TCGA_SKCM_data$TCGA.SKCM.RNAseq.nonzero
TCGA_SKCM_gene_length_nonzero <- TCGA_SKCM_data$TCGA.SKCM.gene.length.nonzero
TCGA_SKCM_gene_name_nonzero <- TCGA_SKCM_data$TCGA.SKCM.gene.name.nonzero
TCGA_nonzero_idx <- TCGA_SKCM_data$nonzero.idx
save(TCGA_SKCM_data, TCGA_SKCM_emsembl_idx, TCGA_SKCM_RNAseq, TCGA_SKCM_RNAseq_gl,
TCGA_SKCM_gene_id, TCGA_SKCM_gene_id_common_ensembl, TCGA_SKCM_gene_length,
TCGA_SKCM_gene_name, TCGA_SKCM_idx, TCGA_SKCM_RNAseq_nonzero, TCGA_SKCM_gene_length_nonzero,
TCGA_SKCM_gene_name_nonzero,TCGA_nonzero_idx,file = 'TCGA_SKCM_data.RData')
?`CDSeq-R-package`
?CDSeq
detectCores()
library(parallel)
detectCores()
## run CDSeq
TCGA_SKCM_CDSeq_result <- CDSeq(bulk_data = TCGA_SKCM_RNAseq_nonzero, cell_type_number = 15, mcmc_iterations = 700,
dilution_factor = 100, block_number = 10, gene_subset_size = 1000, cpu_number = 10,
gene_length = as.vector(TCGA_SKCM_gene_length_nonzero))
setwd("~/Dropbox/Public/MIT/CDSeq_R_package/CDSeq")
library(CDSeq)
load("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis/GTEx_lung_blood.RData")
View(GTEx_gene_names_original)
View(GTEx_sample_blood_index)
dim(GTEx_gene_names)
dim(GTEx_RNAseq_blood)
load("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis/GTEx_data.RData")
which()
View(GTEx_data)
load("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis/GENE_NAME_and_LENGTH.RData")
# get the gene length
GTEx_gene_names_common <- intersect(GTEx_gene_names,gene_name)
length(GTEx_gene_names_common)
setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
# save the data from MATLAB
GTEx_data <- readMat('GTEx_data_V8.mat')
library(R.matlab)
# save the data from MATLAB
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_sample_ID_all <- GTEx_data$GTEx.sampleID.all
GTEx_sample_IDs <- GTEx_data$GTEx.sampleIDs
GTEx_sample_tissue <- GTEx_data$GTEx.sample.tissue
GTEx_RNAseq_lung <- GTEx_data$GTEx.RNAseq.lung
GTEx_sample_ID_lung <- GTEx_data$GTEx.sample.ID.lung
GTEx_sample_ID_lung_common <- GTEx_data$GTEx.sample.lung.ID.common
GTEx_sample_lung_index <- GTEx_data$GTEx.sample.lung.index
GTEx_sample_lung_index_anno <- GTEx_data$GTEx.sample.lung.index.anno
GTEx_RNAseq_blood <- GTEx_data$GTEx.RNAseq.blood
GTEx_sample_ID_blood <- GTEx_data$GTEx.sample.ID.blood
GTEx_sample_blood_ID_common <- GTEx_data$GTEx.sample.blood.ID.common
GTEx_sample_blood_index <- GTEx_data$GTEx.sample.blood.index
GTEx_sample_blood_index_anno <- GTEx_data$GTEx.sample.blood.index.anno
GTEx_gene_names <- GTEx_data$GTEx.gene.names
GTEx_gene_names_original <- GTEx_data$GTEx.gene.names.original
GTEx_RNAseq_blood_gl <- GTEx_data$GTEx.RNAseq.blood.gl
GTEx_RNAseq_lung_gl <- GTEx_data$GTEx.RNAseq.lung.gl
GTEx_gene_length <-GTEx_data$GTEx.gene.length
save(GTEx_data,file = 'GTEx_data.RData')
save(GTEx_gene_names,GTEx_gene_names_original,GTEx_RNAseq_blood,GTEx_RNAseq_lung,GTEx_sample_blood_ID_common,GTEx_sample_blood_index,
GTEx_sample_blood_index_anno,GTEx_sample_ID_all,GTEx_sample_ID_blood,GTEx_sample_ID_lung,GTEx_sample_ID_lung_common,
GTEx_RNAseq_blood_gl,GTEx_RNAseq_lung_gl,GTEx_gene_length,
GTEx_sample_IDs,GTEx_sample_lung_index,GTEx_sample_lung_index_anno,GTEx_sample_tissue,file = 'GTEx_lung_blood.RData')
dim(GTEx_RNAseq_lung_gl)
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_lung_gl)>read_counts_threshold)
GTEx_RNAseq_lung_gl_filtered <- GTEx_RNAseq_lung_gl[tmp_idx,]
dim(GTEx_RNAseq_lung_gl_filtered)
dim(GTEx_gene_names)
length(GTEx_gene_names)
length(GTEx_gene_length)
length(GTEx_gene_names_original)
# save the data from MATLAB
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_gene_names_common <- GTEx_data$GTEx.gene.names.common
save(GTEx_data,file = 'GTEx_data.RData')
save(GTEx_gene_names,GTEx_gene_names_original,GTEx_RNAseq_blood,GTEx_RNAseq_lung,GTEx_sample_blood_ID_common,GTEx_sample_blood_index,
GTEx_sample_blood_index_anno,GTEx_sample_ID_all,GTEx_sample_ID_blood,GTEx_sample_ID_lung,GTEx_sample_ID_lung_common,
GTEx_RNAseq_blood_gl,GTEx_RNAseq_lung_gl,GTEx_gene_length,GTEx_gene_names_common,
GTEx_sample_IDs,GTEx_sample_lung_index,GTEx_sample_lung_index_anno,GTEx_sample_tissue,file = 'GTEx_lung_blood.RData')
dim(GTEx_RNAseq_lung_gl)
length(GTEx_gene_names_common)
length(GTEx_gene_length)
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_lung_gl)>read_counts_threshold)
GTEx_RNAseq_lung_gl_filtered <- GTEx_RNAseq_lung_gl[tmp_idx,]
GTEx_gene_names_gl_filtered <- GTEx_gene_names_common[tmp_idx]
length(GTEx_gene_names_gl_filtered)
GTEx_gene_length_lung_filtered <- GTEx_gene_length[tmp_idx]
length(GTEx_gene_length_lung_filtered)
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_blood_gl)>read_counts_threshold)
GTEx_RNAseq_blood_gl_filtered <- GTEx_RNAseq_blood_gl[tmp_idx,]
GTEx_gene_names_blood_filtered <- GTEx_gene_names_common[tmp_idx]
GTEx_gene_length_blood_filtered <- GTEx_gene_length[tmp_idx]
dim(GTEx_RNAseq_blood_gl_filtered)
dim(GTEx_gene_length_blood_filtered)
length(GTEx_gene_length_blood_filtered)
length(GTEx_gene_length_lung_filtered)
save(read_counts_threshold,tmp_idx,GTEx_RNAseq_lung_gl_filtered,GTEx_gene_names_lung_filtered,GTEx_gene_length_lung_filtered,file = 'GTEx_lung.RData')
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_lung_gl)>read_counts_threshold)
GTEx_RNAseq_lung_gl_filtered <- GTEx_RNAseq_lung_gl[tmp_idx,]
GTEx_gene_names_lung_filtered <- GTEx_gene_names_common[tmp_idx]
GTEx_gene_length_lung_filtered <- GTEx_gene_length[tmp_idx]
save(read_counts_threshold,tmp_idx,GTEx_RNAseq_lung_gl_filtered,GTEx_gene_names_lung_filtered,GTEx_gene_length_lung_filtered,file = 'GTEx_lung.RData')
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_blood_gl)>read_counts_threshold)
GTEx_RNAseq_blood_gl_filtered <- GTEx_RNAseq_blood_gl[tmp_idx,]
GTEx_gene_names_blood_filtered <- GTEx_gene_names_common[tmp_idx]
GTEx_gene_length_blood_filtered <- GTEx_gene_length[tmp_idx]
save(read_counts_threshold,tmp_idx,GTEx_RNAseq_blood_gl_filtered,GTEx_gene_names_blood_filtered,GTEx_gene_length_blood_filtered,file = 'GTEx_blood.RData')
setwd("~/Dropbox/Public/MIT/CDSeq_R_package/CDSeq")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
library(DESeq2)
AD.scRNA.Yongjin <- readRDS("~/Dropbox/Public/MIT/brain_2018-05-03/AD.scRNA.Yongjin.rds")
dim(AD.scRNA.Yongjin$counts)
View(AD.scRNA.Yongjin$colAnnotations)
dim(AD.scRNA.Yongjin$colAnnotations)
View(AD.scRNA.Yongjin$counts)
class(AD.scRNA.Yongjin$counts)
AD.scRNA.Yongjin$counts[2,3]
AD.scRNA.Yongjin$counts[2,5]
AD.scRNA.Yongjin$counts[2009,5293]
sum(AD.scRNA.Yongjin$counts)
AD.scRNA.Yongjin$colAnnotations[1]
dim(AD.scRNA.Yongjin$colAnnotations)
dim(AD.scRNA.Yongjin$counts)
require(Matrix)
filtered.counts <- readMM("filtered_count_matrix.mtx")
rownames(filtered.counts) <- readLines("filtered_gene_row_names.txt")
filtered.colMetadata <- read.delim("filtered_column_metadata.txt")
notfiltered.counts <- readMM("notfiltered_count_matrix.mtx")
notfiltered.rowMeatada <- read.delim("notfiltered_gene_row_names.txt", header = F)
rownames(notfiltered.counts) <- notfiltered.rowMeatada[,2]
notfiltered.colMetadata <- read.delim("notfiltered_column_metadata.txt")
filtered.counts <- readMM("filtered_count_matrix.mtx")
rownames(filtered.counts) <- readLines("filtered_gene_row_names.txt")
filtered.colMetadata <- read.delim("filtered_column_metadata.txt")
setwd("~/Dropbox/Public/MIT/brain_2018-05-03")
dim(filtered.counts)
filtered.counts <- readMM("filtered_count_matrix.mtx")
rownames(filtered.counts) <- readLines("filtered_gene_row_names.txt")
filtered.colMetadata <- read.delim("filtered_column_metadata.txt")
dim(filtered.counts)
View(filtered.counts)
class(filtered.counts)
sum(filtered.counts)
max(colSums(filtered.counts))
min(colSums(filtered.counts))
max(colsum(AD.scRNA.Yongjin$counts))
max(colSums(AD.scRNA.Yongjin$counts))
min(colSums(AD.scRNA.Yongjin$counts))
barplot(AD.scRNA.Yongjin$counts)
barplot(ColSums(AD.scRNA.Yongjin$counts))
barplot(colSums(AD.scRNA.Yongjin$counts))
mean(colSums(AD.scRNA.Yongjin$counts))
median(colSums(AD.scRNA.Yongjin$counts))
setwd("~/Dropbox/Public/MIT/CDSeq_R_package/CDSeq")
remove.packages("CDSeq")
library(devtools)
install_github("kkang7/CDSeq_R_Package")
library(CDSeq)
?`CDSeq-R-package`
?CDSeq
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
library(CDSeq)
?CDSeq
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1,
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 10,
dilution_factor = 1, block_number = 2, gene_subset_size = 10,
reference_gep = refGEP, cpu_number=2, print_progress_msg_to_file=1)
install.packages("tictoc")
library(CDSeq)
library(R.matlab)
library(Rcpp)
library(tictoc)
library(MASS)
library(foreach)
library(doParallel)
library(RcppThread)
library(ggpubr)
library(CDSeq)
ExptData<-readMat("/Users/kangk3/Dropbox/Public/NIH/Project_1_R_package/CDSeqRpackage_001/Deconvolution_Experimental_data_shrink_10.mat")
ExptMixGEP<-ExptData$WD
ExptGeneLength <- ExptData$el.wd
ExptRefGEP <- ExptData$cells.filered.wd
ExptTrueRPKM <- ExptData$phi.org.rpkm
ExptTrueGeneRate <- ExptData$phi.org.gene.wd
ExptTrueReadRate <- ExptData$phi.org.read.wd
ExptTruePropRNAadj <- ExptData$theta.adjcont
ExptTruePropRNA <-ExptData$theta
ExptData<-readMat("/Users/kaikang/Dropbox/Public/NIH/Project_1_R_package/CDSeqRpackage_001/Deconvolution_Experimental_data_shrink_10.mat")
ExptMixGEP<-ExptData$WD
ExptGeneLength <- ExptData$el.wd
ExptRefGEP <- ExptData$cells.filered.wd
ExptTrueRPKM <- ExptData$phi.org.rpkm
ExptTrueGeneRate <- ExptData$phi.org.gene.wd
ExptTrueReadRate <- ExptData$phi.org.read.wd
ExptTruePropRNAadj <- ExptData$theta.adjcont
ExptTruePropRNA <-ExptData$theta
#result_Expt<-CDSeq(mydata = ExptMixGEP,T=4, N=700, shrinker=1, gene_length = as.vector(ExptGeneLength), referenceGEP = ExptRefGEP)
result_Expt <- CDSeq(bulk_data =  ExptMixGEP, cell_type_number = 4, mcmc_iterations = 700, dilution_factor = 1, block_number =  1, gene_length = as.vector(ExptGeneLength), reference_gep = ExptRefGEP)
?`CDSeq-R-package`
?CDSeq
library(CDSeq)
?CDSeq
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=1, print_progress_msg_to_file=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=2)
library(CDSeq)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=2)
library(CDSeq)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=2)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=1, print_progress_msg_to_file=1)
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 2:4, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
cpu_number=1)
library(CDSeq)
library(CDSeq)
ExptData<-readMat("/Users/kaikang/Dropbox/Public/NIH/Project_1_R_package/CDSeqRpackage_001/Deconvolution_Experimental_data_shrink_10.mat")
ExptMixGEP<-ExptData$WD
ExptGeneLength <- ExptData$el.wd
ExptRefGEP <- ExptData$cells.filered.wd
ExptTrueRPKM <- ExptData$phi.org.rpkm
ExptTrueGeneRate <- ExptData$phi.org.gene.wd
ExptTrueReadRate <- ExptData$phi.org.read.wd
ExptTruePropRNAadj <- ExptData$theta.adjcont
ExptTruePropRNA <-ExptData$theta
##====================================================================================================================
library(R.matlab)
ExptData<-readMat("/Users/kaikang/Dropbox/Public/NIH/Project_1_R_package/CDSeqRpackage_001/Deconvolution_Experimental_data_shrink_10.mat")
ExptMixGEP<-ExptData$WD
ExptGeneLength <- ExptData$el.wd
ExptRefGEP <- ExptData$cells.filered.wd
ExptTrueRPKM <- ExptData$phi.org.rpkm
ExptTrueGeneRate <- ExptData$phi.org.gene.wd
ExptTrueReadRate <- ExptData$phi.org.read.wd
ExptTruePropRNAadj <- ExptData$theta.adjcont
ExptTruePropRNA <-ExptData$theta
# Reduce Recover
result_Expt_RR <- CDSeq(bulk_data =  ExptMixGEP, cell_type_number = 4, mcmc_iterations = 700, dilution_factor = 1, gene_subset_size = 500,
block_number =  7, gene_length = as.vector(ExptGeneLength), reference_gep = ExptRefGEP)
par(mar=c(1,1,1,1))
par(mfrow=c(4,4))
for (i in 1:4) {
for (j in 1:4) {
plot(ExptTrueRPKM[,i],result_Expt_RR$estGEP[,j])
lines(c(0,8500),c(0,8500),type = "l")
}
}
par(mfrow=c(4,4))
for (i in 1:4) {
for (j in 1:4) {
plot(ExptTruePropRNAadj[,i],result_Expt_RR$estProp[j,])
lines(c(0,.5),c(0,.5), type = "l")
}
}
dim(ExptMixGEP)
# Reduce Recover
result_Expt_RR <- CDSeq(bulk_data =  ExptMixGEP, cell_type_number = 4, mcmc_iterations = 700, dilution_factor = 1, gene_subset_size = 500,
block_number =  10, gene_length = as.vector(ExptGeneLength), reference_gep = ExptRefGEP,cpu_number = 10)
par(mar=c(1,1,1,1))
par(mfrow=c(4,4))
for (i in 1:4) {
for (j in 1:4) {
plot(ExptTrueRPKM[,i],result_Expt_RR$estGEP[,j])
lines(c(0,8500),c(0,8500),type = "l")
}
}
par(mfrow=c(4,4))
for (i in 1:4) {
for (j in 1:4) {
plot(ExptTruePropRNAadj[,i],result_Expt_RR$estProp[j,])
lines(c(0,.5),c(0,.5), type = "l")
}
}
# Reduce Recover
result_Expt_RR <- CDSeq(bulk_data =  ExptMixGEP, cell_type_number = 4, mcmc_iterations = 700, dilution_factor = 1, gene_subset_size = 1000,
block_number =  10, gene_length = as.vector(ExptGeneLength), reference_gep = ExptRefGEP,cpu_number = 10)
par(mar=c(1,1,1,1))
par(mfrow=c(4,4))
for (i in 1:4) {
for (j in 1:4) {
plot(ExptTruePropRNAadj[,i],result_Expt_RR$estProp[j,])
lines(c(0,.5),c(0,.5), type = "l")
}
}
library(PREDE)
?CDSeq
library(CDSeq)
?`CDSeq-R-package`
?CDSeq
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 10,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
View(mixtureGEP)
load("~/Dropbox/Public/MIT/CDSeq_R_package/CDSeq/data/SyntheticMixtureData.RData")
result<-CDSeq(bulk_data =  mixtureGEP, cell_type_number = 6, mcmc_iterations = 700,
dilution_factor = 1, block_number = 1, gene_length = as.vector(gene_length),
reference_gep = refGEP, cpu_number=1, print_progress_msg_to_file=1)
par(mar=c(1,1,1,1))
par(mfrow=c(6,6))
for (i in 1:6) {
for (j in 1:6) {
plot(true_prop_cell[i,],result$estProp[j,])
lines(c(0,1),c(0,1), type = "l")
}
}
?PREDE
result_prede <- PREDE(mixtureGEP)
dim(refGEP)
result_prede <- PREDE(mixtureGEP, W1 = refGEP[,1])
result_prede <- PREDE(mixtureGEP, W1 = refGEP[,1], K=6)
result_prede <- PREDE(mixtureGEP, refGEP[,1], K=6)
result_prede <- PREDE(Y=mixtureGEP, W1=refGEP[,1], K=6)
result_prede <- PREDE(Y=mixtureGEP, W1=refGEP[,1], K=5)
data("SyntheticMixtureData")
dim(mixtureGEP)
data(lung_exp)
W <- lung_exp[,1:6]
bulk <- GenerateMixSample(W,nSample =100,csd = 0.1)
PREDE(bulk$Y,W1=W[,1:4],type = "GE",K=7,iters = 500,rssDiffStop=1e-10)
result_prede <- PREDE(Y=mixtureGEP, W1=refGEP[,1], K=5,iters = 500,rssDiffStop=1e-10)
result_prede <- PREDE(Y=mixtureGEP, W1=refGEP[,1:2], K=5,iters = 500,rssDiffStop=1e-10)
bulk <- GenerateMixSample(W,nSample =100,csd = 0.1)
a<-PREDE(bulk$Y,W1=W[,1],type = "GE",K=7,iters = 500,rssDiffStop=1e-10)
