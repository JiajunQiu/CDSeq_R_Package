setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
library(R.matlab)
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_data$GTEx.gene.names[1]
GTEx_gene_names <- unlist(GTEx_data$GTEx.gene.names)
length(GTEx_gene_names)
GTEx_gene_names[1]
GTEx_gene_names[2]
GTEx_sample_IDs <- unlist(GTEx_data$GTEx.sampleIDs)
GTEx_sample_IDs[1]
length(GTEx_sample_IDs)
GTEx_sample_ID_all <- unlist(GTEx_data$GTEx.sampleID.all)
length(GTEx_sample_ID_all)
GTEx_sample_tissue <- unlist(GTEx_data$GTEx.sample.tissue)
length(GTEx_sample_tissue)
GTEx_RNAseq_lung<-GTEx_data$GTEx.RNAseq.lung
dim(GTEx_RNAseq_lung)
class(GTEx_RNAseq_lung)
GTEx_sample_ID_lung <- unlist(GTEx_data$GTEx.sample.ID.lung)
GTEx_sample_ID_lung_common<-unlist(GTEx_data$GTEx.sample.lung.ID.common)
GTEx_sample_lung_index<-unlist(GTEx_data$GTEx.sample.lung.index)
GTEx_sample_lung_index_anno<-unlist(GTEx_data$GTEx.sample.lung.index.anno)
GTEx_RNAseq_blood<-GTEx_data$GTEx.RNAseq.blood
class(GTEx_RNAseq_blood)
GTEx_sample_ID_blood<-unlist(GTEx_data$GTEx.sample.ID.blood)
GTEx_sample_blood_ID_common<-unlist(GTEx_data$GTEx.sample.blood.ID.common)
GTEx_sample_blood_index<-unlist(GTEx_data$GTEx.sample.blood.index)
class(GTEx_sample_blood_index)
GTEx_sample_blood_index_anno<-unlist(GTEx_data$GTEx.sample.blood.index.anno)
GTEx_data$MCOS
dim(GTEx_RNAseq_lung)
# save the data from MATLAB
save(GTEx_data,file = 'GTEx_data.RData')
save(GTEx_gene_names,GTEx_RNAseq_blood,GTEx_RNAseq_lung,GTEx_sample_blood_ID_common,GTEx_sample_blood_index,
GTEx_sample_blood_index_anno,GTEx_sample_ID_all,GTEx_sample_ID_blood,GTEx_sample_ID_lung,GTEx_sample_ID_lung_common,
GTEx_sample_IDs,GTEx_sample_lung_index,GTEx_sample_lung_index_anno,GTEx_sample_tissue,file = 'GTEx_lung_blood.RData')
a<-matrix(rexp(10,rate = .1),ncol = 2)
a
a<-ceiling(a)
a
a!=0
which(a)
which(a>1)
which(rowSums(a!=1))
which(rowSums(a!=1)>0)
rowSums(a>1)
rowSums(a!=1)
rowSums(a!=0)
# filter the data
read_counts_threshold <- 100
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
# filter the data
read_counts_threshold <- 500
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
# filter the data
read_counts_threshold <- 0
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
dim(GTEx_RNAseq_lung)
# filter the data
read_counts_threshold <- 100
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
# filter the data
read_counts_threshold <- 1000
tmp_idx <- which(rowSums(GTEx_RNAseq_lung)>read_counts_threshold)
GTEx_RNAseq_lung_filtered <- GTEx_RNAseq_lung[tmp_idx,]
dim(GTEx_RNAseq_lung_filtered)
sum(GTEx_RNAseq_lung_filtered)
setwd("~/Dropbox/Public/MIT/CDSeq_R_package")
install.packages('CDSeq_1.0.4.tar.gz',repos = NULL, type = "source")
library(CDSeq)
pwd
setwd("~/Dropbox/Public/NIH/Project 1/Deconvolution_MATLAB_code")
# gene name and gene length
gene_name_and_gene_length <- readMat('GENE_NAME_AND_LENGTH.mat')
gene_name <- unlist(gene_name_and_gene_length$GENE.NAME.LIST)
gene_length <- unlist(gene_name_and_gene_length$GENE.NAME.LENGTH)
setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
save(gene_length,gene_name,file = 'GENE_NAME_and_LENGTH.RData')
length(GTEx_gene_names)
length(gene_name)
a<-c(1,4,5)
b<-c(3,4,3,2,5,9)
intersect(a,b)
a<-c(1,5,4,5)
intersect(a,b)
a<-c('a','g','d','e')
b<-c('b','c','a','e','d')
intersect(a,b)
intersect(a,b)
c<-intersect(a,b)
c
match(c,a)
a
# get the gene length
GTEx_gene_names_common <- intersect(GTEx_gene_names,gene_name)
length(GTEx_gene_names_common)
view(GTEx_gene_names)
View(GTEx_gene_names)
setwd("~/Dropbox/Public/MIT/Project_2_GTEx_data_analysis")
GTEx_data <- readMat('GTEx_data_V8.mat')
GTEx_gene_names_original<-GTEx_data$GTEx.gene.names.original
# save the data from MATLAB
save(GTEx_data,file = 'GTEx_data.RData')
save(GTEx_gene_names,GTEx_gene_names_original,GTEx_RNAseq_blood,GTEx_RNAseq_lung,GTEx_sample_blood_ID_common,GTEx_sample_blood_index,
GTEx_sample_blood_index_anno,GTEx_sample_ID_all,GTEx_sample_ID_blood,GTEx_sample_ID_lung,GTEx_sample_ID_lung_common,
GTEx_sample_IDs,GTEx_sample_lung_index,GTEx_sample_lung_index_anno,GTEx_sample_tissue,file = 'GTEx_lung_blood.RData')
View(GTEx_RNAseq_lung_filtered)
if (!requireNamespace("BiocManager", quietly=TRUE))
install.packages("BiocManager")
BiocManager::install("TCGAbiolinks")
library(TCGAbiolinks)
library(dplyr)
library(DT
)
packageVersion("TCGAbiolinks")
setwd("~/Dropbox/Public/MIT/Project_3_SKCM")
# TCGA SKCM data
TCGA_SKCM_data <- readMat('TCGA_SKCM_data.mat')
TCGA_SKCM_emsembl_idx <- TCGA_SKCM_data$EMSEMBL.idx
TCGA_SKCM_RNAseq <- TCGA_SKCM_data$TCGA.SKCM.RNAseq
TCGA_SKCM_RNAseq_gl <- TCGA_SKCM_data$TCGA.SKCM.RNAseq.gl
TCGA_SKCM_gene_id <- TCGA_SKCM_data$TCGA.SKCM.gene.id
TCGA_SKCM_gene_id_common_ensembl <- TCGA_SKCM_data$TCGA.SKCM.gene.id.common.ensembl
TCGA_SKCM_gene_length <- TCGA_SKCM_data$TCGA.SKCM.gene.length
TCGA_SKCM_gene_name <- TCGA_SKCM_data$TCGA.SKCM.gene.name
TCGA_SKCM_idx <- TCGA_SKCM_data$TCGA.idx
TCGA_SKCM_RNAseq_nonzero <- TCGA_SKCM_data$TCGA.SKCM.RNAseq.nonzero
TCGA_SKCM_gene_length_nonzero <- TCGA_SKCM_data$TCGA.SKCM.gene.length.nonzero
TCGA_SKCM_gene_name_nonzero <- TCGA_SKCM_data$TCGA.SKCM.gene.name.nonzero
TCGA_nonzero_idx <- TCGA_SKCM_data$nonzero.idx
save(TCGA_SKCM_data, TCGA_SKCM_emsembl_idx, TCGA_SKCM_RNAseq, TCGA_SKCM_RNAseq_gl,
TCGA_SKCM_gene_id, TCGA_SKCM_gene_id_common_ensembl, TCGA_SKCM_gene_length,
TCGA_SKCM_gene_name, TCGA_SKCM_idx, TCGA_SKCM_RNAseq_nonzero, TCGA_SKCM_gene_length_nonzero,
TCGA_SKCM_gene_name_nonzero,TCGA_nonzero_idx,file = 'TCGA_SKCM_data.RData')
?`CDSeq-R-package`
?CDSeq
detectCores()
library(parallel)
detectCores()
## run CDSeq
TCGA_SKCM_CDSeq_result <- CDSeq(bulk_data = TCGA_SKCM_RNAseq_nonzero, cell_type_number = 15, mcmc_iterations = 700,
dilution_factor = 100, block_number = 10, gene_subset_size = 1000, cpu_number = 10,
gene_length = as.vector(TCGA_SKCM_gene_length_nonzero))
setwd("~/Dropbox/Public/MIT/CDSeq_R_package/CDSeq")
